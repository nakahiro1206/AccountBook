# AccountBook

趣旨: 運動部の経理で使用していた帳簿作成プログラム。銀行のウェブサイトから取得できる入出金明細と集金や立て替えの返金、取引先への振り込みなどの活動上把握できている収支を一致していることを確認しつつ見やすく書き換える。

### 実装内容

1. はじめに入力ファイルの収支にズレがないことを確認する。
2. シート[未納・未返金]からあらかじめ名前と取引のリストが結びついた辞書を作成。そしてシート[入出金明細(原本)]　から内容を読み取る。
3. シート[対応表]をもとに原本で表示される名前を帳簿で表示する名前に変換(例えば半角カタカナを漢字に、など)
   a. 対応表になければシート[未処理(原本)]に移動 
5. 未納・未返金のものから名前が一致するものを取り出し、全ビット探索で金額が一致するものを探す。
   a. 一致するものがあればそれを帳簿に書き込む。なければシート[未処理(原本)]に移動
6. すべての原本の取引が処理し終われば、再度収支がずれていないことを確認。
7. シート[未処理(原本)]が空欄であれば、外部の方が見やすいように不要なファイルを非表示にしたまとめモードに変換。

### 工夫点

1. 人手で記入すべき部分を最小限にすることで名前の表記揺れや数値の入力ミスによる不具合が起こらないようにした。
2. Excel ファイルの読み込みが遅く処理に時間がかかることを避けるために、関数の引数にファイルオブジェクトを渡した場合の返り値でそれを返すことで使いまわせるようにした。ロードや保存の手間が省け大幅に処理時間が短縮できた。
3. 3.a. や5.a.でシート[未処理(原本)]に原本の取引を移動する際、シート[未納・未返金]に候補となるような雛形を書き込んでおくことでシート[未納・未返金]の変数を楽に行えるようにした。
4. 取引が多くなるとファイルの可読性が下がるため、複数項目などで日付や名前が一致している場合にはそこのセルを合併することで可読性を向上した。
